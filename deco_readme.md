# チャットデコレーション! Chat Decoration! for わんコメ v0.4

最終更新日：2024/03/27

配信者のためのコメントアプリ「わんコメ」で使用できるテンプレートを生成するWEBアプリです。

## このコードを利用するときは

- わんコメ(https://onecomme.com/) の利用規約に基づきます。
- わんコメの利用規約に基づき、コードに限っては商業利用も含め自由に利用することができます。
- このコードの使用に関連して生じた損害について一切の責任を負いません。このコードの使用は自己責任で行ってください。
- 現在はベータ版のため、コードの動作は保証しません。コードや仕様は予告なく変更される可能性があります。
- わんコメのテンプレートをベースに改変しており、テンプレエディタを適用できます。ただし、すべてのエディタの変更を保証するものではありません。

## このテンプレートは何？

### !deco を付けてチャットすると、背景色が変化!

- !deco をチャットの頭に付けると、ランダムで背景色が変化します。ランダムには重さを付けることも可能。10回に1回しか出ない、レアなデコレーションも作れちゃう。
- 標準で10パターン。「しろ」「くろ」「あか」「おれんじ」「きいろ」「みどり」「みずいろ」「あお」「むらさき」「ぴんく」
- 「!deco しろ」とコメントすると、該当する色のデコレーションを指定できます。
- なお、ギフト、スーパーチャットの文字色・背景色は、デコレーションよりも優先されます。

### 手持ちのキャラクター画像をチャット欄に追加!

- \_\_user__.jsを編集することで、手持ちのキャラクター画像をチャット欄に飾れます。
- 画像はimgフォルダに入れてね。画像は400px x 200pxくらいがいいかも。

### プレゼント企画に！ユーザー専用のデコレーションも。

- メンバー専用やモデレーター専用、特定のユーザー専用のデコレーションも追加できます。派手にカスタマイズして、視聴者さんを驚かそう！

## 導入方法

### テンプレートをOBSに追加する

- わんコメの右上にある【…】(三点リーダー) ＞ フォルダを開く ＞ テンプレートフォルダ を選択
- customフォルダに、解答したフォルダ「..._deco」を入れる
- 「..._deco」のテンプレートをOBSに追加

### 【重要】OBSの設定・プロパティを変更する

- 追加したテンプレート「index.html」という名称から、わかりやすい名前に変更する(deco等)
- プロパティから**「OBSで音声を制御する」と、「表示されていないときにソースをシャットダウンする」にチェック☑**を入れる
- プロパティから幅・高さを変更する。目安としては、幅550、高さ1080です(画面が1920x1080の場合)
- OBSの音声ミキサーの【︙】(三点リーダー)＞「オーディオの詳細プロパティ」から、↑で変更したWordPartyの名称を探し、「音声モニタリング」の設定を「モニターと出力」に変更する
  - この設定をしていないと、**「配信者は聞こえるのに配信動画では音声が乗っていない」「アナウンスが二重三重に出てくる」「非表示にしてるのに勝手に音声が鳴る」といった不具合**が出ます。

## 使い方・カスタマイズ

### _\_user__.jsをテキストエディタで編集する

- そのままでも一応使えますが、**カスタマイズ推奨**です。
- 「...\_deco」フォルダに入っている、「_\_user__.js」というファイルを、テキストエディターで開きます。

### カスタマイズ：基本設定

- Userlevel:!decoでデコレーションできる権限
  - 0:だれでも 1:メンバー以上 2:モデレーター以上 3:配信者のみ 4:!deco機能OFF
- defaultALLdeco:チャットした全員にデフォルトでデコを付与する
  - 0:OFF 1:ON 2:毎回ランダムにする
  - Userlevelを4にしていても、こちらが1であれば、こちらが優先されデコレーションが付きます。
- user_decoration_switch:ユーザー別デコレーションセットを有効にする
  - 0:OFF 1:ON
  - この機能はdefaultALLdecoと似てますが、一度!decoするとこのデコレーションが上書きされます。
- gradation_switch:色やグラデーションを付ける
  - 0:OFF 1:ON
  - 背景画像のみ使う場合にONにします。
- announce_flag:アナウンスを有効にする。
  - 0:OFF 1:最初のアナウンスのみ 2:ON
  - 2にすると、変更が入る度にアナウンスされるので、ちょっとうるさいかも。
- images_dir:画像ディレクトリ。
  - 基本はそのままで大丈夫です。

### カスタマイズ:基本デコレーションセット

- ran:出現率。数が多いほど、出やすくなります。逆に0にすれば、ランダムでは出現しなくなります。
- deco:デコレーションの名前。アナウンスの際に使います
- img:画像ディレクトリにある画像を読み込みます
  - [{ ran: 3,img: "boy01_cap01.gif" }, { ran: 2,img: "boy05_bee01.gif" },] と配列にすると、ranの合計を分母にランダムに選択します。
- word:!deco の後に該当するワードがあれば、それを適用します
  - 例:!deco しろ　→「しろ」のデコレーションが適用されます

### カスタマイズ:ユーザー別デコレーションセット

- !decoの投稿がある場合は、そちらを優先します
- userlevel:0:全員 1:メンバー 2:モデレーター 3:配信者 に該当するユーザー、または、表示名が一致するユーザーの色を変更します
- img:画像ディレクトリにある画像を読み込みます


### 【上級】カスタマイズ:文字色・グラデーションの変更

- CSSが分かる人なら、グラデーションの変更や、文字色の変更も可能です。
  - CSSをObjectで渡してるので、CSSとは書き方が少し違う点はご了承下さい
  - 見た目が派手なグラデーションなら、Gradient Magic https://www.gradientmagic.com/　がおすすめです
- textcolor:テキストの文字色
- backgroundcolor:コメントの背景色
- gradation:コメントの背景色（グラデーション）

### 【上級】カスタマイズ:項目を増やす
- 配列ですので、{},の内容を複製すれば項目を増やせます。
  - 詳細は「基本設定ここまで」の下の「deco_data」の関数を見て下さい。
- 数に制限はありませんが、多すぎると処理が重くなるので、ほどほどに…

## 備考：コードの改変について

- このコードの更なる改変はもちろん歓迎しています。必要なカスタマイズを施して下さい。
- また、わんコメの利用規約に基づき、コードに限っては商業利用も含め自由に利用することができます。
- コードがあまり綺麗でない点はご了承ください。

## クレジット：イラストについて

- ドット絵のイラスト：PIXELART TOWN
  https://pixelarttown.net/
- イラスト素材の再配布は、改変したものも含め禁止です。
- イラストの利用については、各配布サイトの利用規約をご確認ください。

## バージョン情報

v0.2 24/03/03 大幅な仕様変更を行いました

- デコを毎回ランダムにする機能を搭載
- デコを削除する機能(!deco clear)の追加
- 他細かい不具合の修正

v0.1 : 24/02/29 初版

------

せすじピンとしてます @pintocuru
https://twitter.com/pintocuru
https://www.youtube.com/@pintocuru
